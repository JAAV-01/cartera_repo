<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Cartera</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/base.css" rel="stylesheet">
    {% block extra_css %}{% endblock %}
    <style>
      /* Posicionar el contenedor de alertas arriba y centrado */
      .flash-container {
        position: fixed;
        top: 12px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1055; /* por encima de la navbar */
        width: min(720px, calc(100% - 24px));
        pointer-events: none; /* los clicks pasan al botón de cerrar dentro */
      }
      .flash-container .alert {
        pointer-events: auto;
        box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      }
    </style>
</head>
<body>

<!-- Navbar -->
<div class="navbar">
  <div class="navbar-top">
    <img src="/assets/img/logo.png" alt="Logo Empresa" class="navbar-logo">
    <h1 class="b-4m">Gestión de Cartera</h1>
    <nav class="navbar-fecha">
      <h1 id="fecha-hora"></h1>
    </nav>
  </div>
</div>

<script>
function actualizarFechaHora() {
  const ahora = new Date();
  const opcionesFecha = { day: "2-digit", month: "2-digit", year: "numeric" };
  const opcionesHora = { hour: "2-digit", minute: "2-digit", second: "2-digit" };
  const fecha = ahora.toLocaleDateString("es-CO", opcionesFecha);
  const hora = ahora.toLocaleTimeString("es-CO", opcionesHora);
  const el = document.getElementById("fecha-hora");
  if (el) el.innerText = `${fecha} • ${hora}`;
}
actualizarFechaHora();
setInterval(actualizarFechaHora, 1000);
</script>

<!-- Flash Messages -->
{% set qmsg  = request.query_params.get("msg") %}
{% set qtype = request.query_params.get("msg_type") %}
{% set flash_text = flash_msg or qmsg %}
{% set flash_kind = (flash_type or qtype or "info")|lower %}
{% if flash_text %}
  {% if   flash_kind == "success" %}
    {% set bs_class = "alert-success" %}
  {% elif flash_kind == "error" %}
    {% set bs_class = "alert-danger" %}
  {% elif flash_kind == "warning" %}
    {% set bs_class = "alert-warning" %}
  {% else %}
    {% set bs_class = "alert-info" %}
  {% endif %}

  <div class="flash-container">
    <div id="flash" class="alert {{ bs_class }} alert-dismissible fade show mb-0" role="alert">
      {{ flash_text }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const flashEl = document.getElementById("flash");
      if (flashEl) {
        // esperar 3s y luego cerrar con animación
        setTimeout(() => {
          flashEl.classList.remove("show"); // activa transición fade-out
          setTimeout(() => {
            if (flashEl.parentNode) {
              flashEl.parentNode.removeChild(flashEl);
            }
          }, 150); // espera la animación fade antes de remover
        }, 3000);
      }
    });
  </script>
{% endif %}

<!-- Contenido de cada vista -->
<div class="container py-4">
  {% block content %}{% endblock %}
</div>

<!-- Bootstrap JS (necesario para alerts dismissibles) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
